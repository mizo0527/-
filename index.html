<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ナンプレ挑戦｜衣料品売場限定</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;margin:0;background:#f6f7fb;color:#111}
    .wrap{max-width:900px;margin:0 auto;padding:18px}
    .card{background:#fff;border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.08);padding:16px;margin:14px 0}
    h1{font-size:20px;margin:0 0 6px}
    .sub{color:#444;font-size:13px;line-height:1.6;margin:0}
    .notice{font-size:13px;line-height:1.7;background:#fff7e6;border:1px solid #ffd18a;border-radius:12px;padding:12px}
    .grid{display:grid;grid-template-columns:repeat(9,1fr);gap:0}
    .cell{width:100%;aspect-ratio:1/1;border:1px solid #cfd3da;display:flex;align-items:center;justify-content:center;background:#fff}
    .cell.thickL{border-left:3px solid #111}
    .cell.thickR{border-right:3px solid #111}
    .cell.thickT{border-top:3px solid #111}
    .cell.thickB{border-bottom:3px solid #111}
    input{
      width:100%;height:100%;
      border:0;outline:none;
      text-align:center;font-size:18px;
      background:transparent;
    }
    input.given{font-weight:700;color:#111}
    input.err{background:#ffe7e7}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    button{
      border:0;border-radius:12px;padding:10px 14px;
      background:#111;color:#fff;font-weight:700;cursor:pointer
    }
    button.sec{background:#e9ecf3;color:#111}
    .msg{font-size:14px;line-height:1.7;margin-top:10px}
    .okBox{
      display:none;
      background:#eaffea;border:1px solid #9be39b;border-radius:14px;
      padding:14px;margin-top:12px
    }
    .okTitle{font-size:18px;font-weight:900;margin:0 0 6px}
    .code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;background:#fff;border:1px solid #cfd3da;border-radius:10px;padding:10px;margin-top:8px}
    .small{font-size:12px;color:#444}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ナンプレ挑戦（解けたら売場の人に声かけて！）</h1>
      <p class="sub">
        クリア画面を衣料品売場スタッフに見せたら、<b>対象商品が2割</b>になります。<br/>
        ※対象は<b>衣料品売場の指定商品</b>のみ／割引条件は店舗運用に準じます
      </p>
    </div>

    <div class="card notice">
      <b>ルール（簡易）</b><br/>
      1〜9を、縦・横・3×3ブロックそれぞれに重複なく入れてください。<br/>
      <span class="small">※このページは通信不要。店内タブレットやスマホでもOK。</span>
    </div>

    <div class="card">
      <div id="board" class="grid" aria-label="sudoku board"></div>

      <div class="row" style="margin-top:12px">
        <button id="checkBtn">完成チェック</button>
        <button id="resetBtn" class="sec">やり直し</button>
        <button id="hintBtn" class="sec">ヒント（1マス）</button>
      </div>

      <div id="status" class="msg"></div>

      <div id="okBox" class="okBox" role="status" aria-live="polite">
        <p class="okTitle">クリア！おつかれさんで！</p>
        <div>
          衣料品売場のスタッフに<b>この画面</b>を見せて、声かけてください。<br/>
          <b>対象商品 2割</b>（衣料品売場の指定商品のみ）
        </div>
        <div class="code">
          今日の合言葉：<b id="dailyWord"></b>
        </div>
        <div class="small" style="margin-top:8px">
          ※合言葉はスタッフ確認用です（当日分のみ有効）
        </div>
      </div>
    </div>

    <div class="card">
      <div class="small">
        運用メモ：<br/>
        ・「対象商品」は売場でPOP指定（色札／棚番号／品番リスト）<br/>
        ・スタッフ対応は「合言葉一致＋クリア画面提示」で統一すると揉めにくい<br/>
      </div>
    </div>
  </div>

<script>
  // ===== ここだけ毎日変える（おすすめ） =====
  const DAILY_WORD = "Otsukare-2026-02-10"; // ←日付を変えるだけでOK

  // ===== サンプル問題（0は空欄） =====
  // これは例。自分の問題に差し替えOK。
  const puzzle = [
    [0,0,0, 2,6,0, 7,0,1],
    [6,8,0, 0,7,0, 0,9,0],
    [1,9,0, 0,0,4, 5,0,0],

    [8,2,0, 1,0,0, 0,4,0],
    [0,0,4, 6,0,2, 9,0,0],
    [0,5,0, 0,0,3, 0,2,8],

    [0,0,9, 3,0,0, 0,7,4],
    [0,4,0, 0,5,0, 0,3,6],
    [7,0,3, 0,1,8, 0,0,0]
  ];

  // 対応する解答（完全一致チェック用）
  const solution = [
    [4,3,5, 2,6,9, 7,8,1],
    [6,8,2, 5,7,1, 4,9,3],
    [1,9,7, 8,3,4, 5,6,2],

    [8,2,6, 1,9,5, 3,4,7],
    [3,7,4, 6,8,2, 9,1,5],
    [9,5,1, 7,4,3, 6,2,8],

    [5,1,9, 3,2,6, 8,7,4],
    [2,4,8, 9,5,7, 1,3,6],
    [7,6,3, 4,1,8, 2,5,9]
  ];

  const boardEl = document.getElementById("board");
  const statusEl = document.getElementById("status");
  const okBoxEl = document.getElementById("okBox");
  const dailyWordEl = document.getElementById("dailyWord");
  dailyWordEl.textContent = DAILY_WORD;

  // 入力欄生成
  const inputs = [];
  function buildBoard(){
    boardEl.innerHTML = "";
    inputs.length = 0;

    for(let r=0;r<9;r++){
      inputs[r]=[];
      for(let c=0;c<9;c++){
        const cell = document.createElement("div");
        cell.className = "cell";

        // 太枠
        if (c % 3 === 0) cell.classList.add("thickL");
        if (c === 8) cell.classList.add("thickR");
        if (r % 3 === 0) cell.classList.add("thickT");
        if (r === 8) cell.classList.add("thickB");

        const inp = document.createElement("input");
        inp.setAttribute("inputmode","numeric");
        inp.setAttribute("maxlength","1");
        inp.setAttribute("aria-label", `r${r+1}c${c+1}`);
        inp.dataset.r = r;
        inp.dataset.c = c;

        const v = puzzle[r][c];
        if(v !== 0){
          inp.value = String(v);
          inp.disabled = true;
          inp.classList.add("given");
        } else {
          inp.addEventListener("input", (e)=>{
            const x = e.target.value.replace(/[^1-9]/g,"");
            e.target.value = x;
            e.target.classList.remove("err");
            okBoxEl.style.display = "none";
            statusEl.textContent = "";
          });
        }

        cell.appendChild(inp);
        boardEl.appendChild(cell);
        inputs[r][c] = inp;
      }
    }
  }

  function getUserGrid(){
    const g = Array.from({length:9},()=>Array(9).fill(0));
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const val = inputs[r][c].value.trim();
        g[r][c] = val ? Number(val) : 0;
      }
    }
    return g;
  }

  function markErrors(user){
    let hasErr = false;
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const inp = inputs[r][c];
        if(inp.disabled) continue;
        inp.classList.remove("err");
        const val = user[r][c];
        if(val !== 0 && val !== solution[r][c]){
          inp.classList.add("err");
          hasErr = true;
        }
      }
    }
    return hasErr;
  }

  function isComplete(user){
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        if(user[r][c] === 0) return false;
      }
    }
    return true;
  }

  function isSolved(user){
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        if(user[r][c] !== solution[r][c]) return false;
      }
    }
    return true;
  }

  // ボタン
  document.getElementById("checkBtn").addEventListener("click", ()=>{
    const user = getUserGrid();

    if(!isComplete(user)){
      statusEl.textContent = "まだ空欄があるで。全部埋めてからチェックしてな。";
      okBoxEl.style.display = "none";
      return;
    }

    const hasErr = markErrors(user);
    if(hasErr){
      statusEl.textContent = "惜しい！赤いマスが間違いの可能性高いで。そこ直してみて。";
      okBoxEl.style.display = "none";
      return;
    }

    if(isSolved(user)){
      statusEl.textContent = "";
      okBoxEl.style.display = "block";
      // 画面上部へ軽くスクロール（スマホで見せやすい）
      okBoxEl.scrollIntoView({behavior:"smooth", block:"start"});
    } else {
      statusEl.textContent = "どこか違うみたいや。赤マス出てない場合は見落としやから、もう一回見直し！";
      okBoxEl.style.display = "none";
    }
  });

  document.getElementById("resetBtn").addEventListener("click", ()=>{
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        const inp = inputs[r][c];
        if(inp.disabled) continue;
        inp.value = "";
        inp.classList.remove("err");
      }
    }
    statusEl.textContent = "";
    okBoxEl.style.display = "none";
  });

  // 1マスだけ正解を入れる（ヒント）
  document.getElementById("hintBtn").addEventListener("click", ()=>{
    const user = getUserGrid();
    // 空欄を探す（ランダム）
    const empties = [];
    for(let r=0;r<9;r++){
      for(let c=0;c<9;c++){
        if(!inputs[r][c].disabled && user[r][c] === 0){
          empties.push([r,c]);
        }
      }
    }
    if(empties.length === 0){
      statusEl.textContent = "もう空欄ないで。完成チェック押してな。";
      return;
    }
    const [r,c] = empties[Math.floor(Math.random()*empties.length)];
    inputs[r][c].value = String(solution[r][c]);
    inputs[r][c].classList.remove("err");
    statusEl.textContent = "ヒント入れたで（1マス）。";
    okBoxEl.style.display = "none";
  });

  buildBoard();
</script>
</body>
</html>
<style>
  body{...}
  .wrap{...}
  .card{...}

  

  button{
    font-size:16px;
    padding:12px;
  }

  .cell input{
    font-size:18px;
    height:40px;
  }

  @media (max-width:520px){
    h1{font-size:18px}
    .card{padding:12px}
  }
</style>
